{% extends 'show_time.html' %}
{% load staticfiles %}


{% block article %}
<article ng-controller="blogPost">
  <!-- 轮播图开始 -->
  <div class="banner">
    <div id="banner" class="fader">
      <li class="slide" ><a href="#" target="_blank"><img src="{% static 'show_time/images/1.jpg' %}"><span class="imginfo">别让这些闹心的套路，毁了你的人生路!</span></a></li>
      <li class="slide" ><a href="#" target="_blank"><img src="{% static 'show_time/images/2.jpg' %}"><span class="imginfo">别让这些闹心的套路，毁了你的人生路！</span></a></li>
      <li class="slide" ><a href="#" target="_blank"><img src="{% static 'show_time/images/3.jpg' %}"><span class="imginfo">别让这些闹心的套路，毁了你的人生路！</span></a></li>
      <div class="fader_controls">
        <div class="page prev" data-target="prev">&lsaquo;</div>
        <div class="page next" data-target="next">&rsaquo;</div>
        <ul class="pager_list">
        </ul>
      </div>
    </div>
  </div>
  <!-- 轮播图结束 -->

  <!-- 公告开始 -->
  <div class="toppic">
    <li> <a href="/" target="_blank"> <i><img src="{% static 'show_time/images/1.jpg' %}"></i>
      <h2>安静地做一个爱设计的女子</h2>
      <span>学无止境</span> </a> </li>
    <li> <a href="/" target="_blank"> <i><img src="{% static 'show_time/images/2.jpg' %}"></i>
      <h2>个人博客，属于我的小世界！</h2>
      <span>学无止境</span> </a> </li>
  </div>
  <!-- 公告结束 -->

  <!-- 文章开始 -->
  <main>
    <div class="blogtab">
        <ul id="blogtab">
            <li class="current">最新文章</li>
            <li><a href="list.html">心得笔记</a></li>
            <li><a href="list.html">CSS3|Html5</a></li>
            <li><a href="list.html">网站建设</a></li>
            <li><a href="list.html">文字标签</a></li>
            <li><a href="list.html">文字广告</a></li>
        </ul>
    </div>
    <div infinite-scroll='post.nextPage()' infinite-scroll-disabled='post.busy' infinite-scroll-distance='1'>
        <div class="blogs" ng-repeat="i in post.items" >
          <h3 class="blogtitle"><a ng-bind="i.title"></a></h3>
            <span class="blogpic"><a  title=""><img src="{% static 'show_time/images/2.jpg' %}" alt=""></a></span>
          <p class="blogtext" ng-bind="i.body"></p>
          <div class="bloginfo">
            <ul>
              <li class="author"><a href="/" ng-bind="i.author"></a></li>
              <li class="lmname"><a href="/">学无止境</a></li>
              <li class="timer" ng-bind="i.updated"></li>
              <li class="view"><span>34567</span>已阅读</li>
              <li class="like">9999</li>
            </ul>
          </div>
            <div style="text-align:right">
                <a href="/article/article-detail/[[i.id]]" style="background:wheat; ">阅读全文</a>
            </div>
        </div>
    </div>

  </main>
  <!-- 博客文章结束 -->

  <!-- 侧边栏开始 -->
  <aside class="r_box" >
      <div class="about_me">
        <h2>博主简介</h2>
        <ul>
          <i><img src="{% static 'show_time/images/4.jpg' %}"></i>
          <p><b>杨青</b>，一个80后草根女站长！09年入行。一直潜心研究web前端技术，一边工作一边积累经验，分享一些个人博客模板，以及SEO优化等心得。</p>
        </ul>
      </div>
      <div class="wdxc">
        <h2>图片精选</h2>
        <ul>
          <li><a href="/"><img src="{% static 'show_time/images/7.jpg' %}"></a></li>
          <li><a href="/"><img src="{% static 'show_time/images/8.jpg' %}"></a></li>
        </ul>
      </div>
      <div class="fenlei">
        <h2>文章分类</h2>
        <ul>
          <li><a href="/">学无止境（33）</a></li>
          <li><a href="/">日记（19）</a></li>
          <li><a href="/">慢生活（520）</a></li>
          <li><a href="/">美文欣赏（40）</a></li>
        </ul>
      </div>
      <div class="tuijian">
        <h2 id="tab"><a href="#"class="current">活动公告</a><a href="#">点击排行</a><a href="#">站长推荐</a></h2>
        
     <div id="content">
        <ul style="display:block;">
          <li><a href="/">第二届 优秀个人博客模板比赛参选活动</a></li>
          <li><a href="/">【活动作品】柠檬绿兔小白个人博客模板</a></li>
        </ul>
                <ul>
          <li><a href="/">你是什么人便会遇上什么人</a></li>
          <li><a href="/">帝国cms 列表页调用子栏目，没有则不显示栏目名称</a></li>
        </ul>
        <ul>
          <li><a href="/">个人博客，我为什么要用帝国cms？</a></li>
          <li><a href="/">D设计师博客-一个热爱生活的设计师</a></li>
        </ul>
       </div>
      </div>
      <div class="guanzhu">
        <h2>关注我 么么哒</h2>
        <ul>
          <img src="{% static 'show_time/images/wx.jpg' %}">
        </ul>
      </div>

  </aside>
  <!-- 侧边栏结束 -->
</article>
{% endblock %}


{% block script %}
<script>
    var myApp = angular.module('blogHomeApp', ['infinite-scroll']).config(function ($interpolateProvider) {
        $interpolateProvider.startSymbol('[[');
        $interpolateProvider.endSymbol(']]');
    });

    myApp.controller('blogPost', ['$scope', '$http', 'Posts', function($scope, $http, Posts){
        $scope.post = new Posts();
        console.log($scope.post)


    }]);

    // 文章列表数据工厂
    myApp.factory('Posts', function($http) {
        var Posts = function() {
            this.items = [];
            this.busy = false;
            this.after = 0;
        };

        Posts.prototype.nextPage = function() {
            if (this.busy) return;
            this.busy = true;

            var url = "{% url 'article:article_list' %}" + "?curr_page=" + this.after + "&per_page=5";
            $http.get(url).success(function(data) {
                var items = data.data;
                if (data.status_code === 404){
                  layer.msg("数据加载完毕！");
                  this.busy = true;
                  return;
                }
                if (data.status_code === 200) {
                  console.log(data.data);
                  for (var i = 0; i < items.length; i++) {
                      this.items.push(items[i]);
                  }
                  this.busy = false;
                }
            }.bind(this));
            this.after++;
        };

        return Posts;
    });

</script>
{% endblock %}

